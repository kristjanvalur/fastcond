<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fastcond GIL Fairness Analysis</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, monospace, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
            background-color: #fafafa;
        }
        
        .header {
            text-align: center;
            background: linear-gradient(135deg, #e74c3c 0%, #f39c12 50%, #27ae60 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 80%, rgba(255,255,255,0.1) 0%, transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(255,255,255,0.1) 0%, transparent 50%);
            pointer-events: none;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .header .subtitle {
            margin: 10px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .header .tagline {
            margin: 15px 0 0 0;
            font-size: 1.1em;
            font-weight: 500;
            color: #fff;
            text-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .mode-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            overflow: hidden;
            border-top: 5px solid;
        }
        
        .mode-fair { border-top-color: #27ae60; }
        .mode-unfair { border-top-color: #f39c12; }
        .mode-naive { border-top-color: #e74c3c; }
        
        .mode-header {
            padding: 20px;
            text-align: center;
        }
        
        .mode-fair .mode-header { background: linear-gradient(135deg, #27ae60, #2ecc71); color: white; }
        .mode-unfair .mode-header { background: linear-gradient(135deg, #f39c12, #e67e22); color: white; }
        .mode-naive .mode-header { background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; }
        
        .mode-header h2 {
            margin: 0;
            font-size: 1.8em;
        }
        
        .mode-header .description {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 0.9em;
        }
        
        .mode-content {
            padding: 20px;
        }
        
        .metric-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .metric-row:last-child {
            border-bottom: none;
        }
        
        .metric-label {
            font-weight: 500;
            color: #555;
        }
        
        .metric-value {
            font-family: 'Monaco', 'Menlo', monospace;
            font-weight: bold;
        }
        
        .metric-excellent { color: #27ae60; }
        .metric-poor { color: #e74c3c; }
        .metric-terrible { color: #8b0000; }
        
        .acquisition-chart {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .acquisition-bar {
            display: flex;
            height: 30px;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .thread-segment {
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 0.8em;
            min-width: 30px;
        }
        
        .thread-0 { background: #3498db; }
        .thread-1 { background: #e74c3c; }
        .thread-2 { background: #f39c12; }
        .thread-3 { background: #27ae60; }
        
        .summary-section {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 30px;
            margin: 30px 0;
        }
        
        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .insight-card {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            border-left: 4px solid #667eea;
        }
        
        .nav-links {
            text-align: center;
            margin: 20px 0;
        }
        
        .nav-links a {
            display: inline-block;
            margin: 0 10px;
            padding: 8px 16px;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            transition: background 0.3s;
        }
        
        .nav-links a:hover {
            background: #5a6fd8;
        }
        
        .system-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin: 20px 0;
            font-size: 0.9em;
            color: #6c757d;
        }
        
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #6c757d;
            border-top: 1px solid #e9ecef;
        }
        
        @media (max-width: 768px) {
            .comparison-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üé≠ GIL Fairness Analysis</h1>
        <div class="subtitle">Demonstrating the critical importance of anti-greedy thread scheduling</div>
        <div class="tagline">Why fairness matters: Preventing thread starvation with minimal performance cost</div>
    </div>
    
    <div class="nav-links">
        <a href="index.html">üìä Performance Benchmarks</a>
        <a href="https://github.com/kristjanvalur/fastcond">‚≠ê GitHub Repository</a>
        <a href="gil-fairness-results.json">üìä Raw Data</a>
    </div>

    <div class="comparison-grid">

        <div class="mode-card mode-fair">
            <div class="mode-header">
                <h2>üí™ FAIR Mode</h2>
                <div class="description">Anti-greedy fairness mechanism prevents thread starvation</div>
            </div>
            <div class="mode-content">

                <div class="acquisition-chart">
                    <h4>Thread Acquisition Distribution</h4>
                    <div class="acquisition-bar">

                        <div class="thread-segment thread-0" style="flex: 12.559999999999999">
                            T0: 1256
                        </div>

                        <div class="thread-segment thread-1" style="flex: 12.47">
                            T1: 1247
                        </div>

                        <div class="thread-segment thread-2" style="flex: 12.55">
                            T2: 1255
                        </div>

                        <div class="thread-segment thread-3" style="flex: 12.5">
                            T3: 1250
                        </div>

                        <div class="thread-segment thread-4" style="flex: 12.370000000000001">
                            T4: 1237
                        </div>

                        <div class="thread-segment thread-5" style="flex: 12.45">
                            T5: 1245
                        </div>

                        <div class="thread-segment thread-6" style="flex: 12.61">
                            T6: 1261
                        </div>

                        <div class="thread-segment thread-7" style="flex: 12.49">
                            T7: 1249
                        </div>

                    </div>
                </div>

                <div class="metric-row">
                    <span class="metric-label">Coefficient of Variation</span>
                    <span class="metric-value metric-excellent">0.006</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Fairness Score</span>
                    <span class="metric-value metric-excellent">0.6</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Thread Transitions</span>
                    <span class="metric-value">100.0%</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Consecutive Re-acquisitions</span>
                    <span class="metric-value">0.0%</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">GIL Acquire/Release Cycles/sec</span>
                    <span class="metric-value">5,816</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Avg Latency per Cycle</span>
                    <span class="metric-value">172.0 Œºs</span>
                </div>
            </div>
        </div>

        <div class="mode-card mode-unfair">
            <div class="mode-header">
                <h2>üèÉ UNFAIR Mode</h2>
                <div class="description">Condition variables without fairness - allows greedy re-acquisition</div>
            </div>
            <div class="mode-content">

                <div class="acquisition-chart">
                    <h4>Thread Acquisition Distribution</h4>
                    <div class="acquisition-bar">

                        <div class="thread-segment thread-0" style="flex: 12.839999999999998">
                            T0: 1284
                        </div>

                        <div class="thread-segment thread-1" style="flex: 12.030000000000001">
                            T1: 1203
                        </div>

                        <div class="thread-segment thread-2" style="flex: 11.68">
                            T2: 1168
                        </div>

                        <div class="thread-segment thread-3" style="flex: 11.52">
                            T3: 1152
                        </div>

                        <div class="thread-segment thread-4" style="flex: 13.350000000000001">
                            T4: 1335
                        </div>

                        <div class="thread-segment thread-5" style="flex: 12.43">
                            T5: 1243
                        </div>

                        <div class="thread-segment thread-6" style="flex: 12.17">
                            T6: 1217
                        </div>

                        <div class="thread-segment thread-7" style="flex: 13.98">
                            T7: 1398
                        </div>

                    </div>
                </div>

                <div class="metric-row">
                    <span class="metric-label">Coefficient of Variation</span>
                    <span class="metric-value metric-excellent">0.068</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Fairness Score</span>
                    <span class="metric-value metric-excellent">6.8</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Thread Transitions</span>
                    <span class="metric-value">15.5%</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Consecutive Re-acquisitions</span>
                    <span class="metric-value">84.5%</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">GIL Acquire/Release Cycles/sec</span>
                    <span class="metric-value">6,053</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Avg Latency per Cycle</span>
                    <span class="metric-value">165.2 Œºs</span>
                </div>
            </div>
        </div>

        <div class="mode-card mode-naive">
            <div class="mode-header">
                <h2>üîí NAIVE Mode</h2>
                <div class="description">Simple mutex - no condition variables or fairness logic</div>
            </div>
            <div class="mode-content">

                <div class="acquisition-chart">
                    <h4>Thread Acquisition Distribution</h4>
                    <div class="acquisition-bar">

                        <div class="thread-segment thread-0" style="flex: 11.89">
                            T0: 1189
                        </div>

                        <div class="thread-segment thread-1" style="flex: 12.41">
                            T1: 1241
                        </div>

                        <div class="thread-segment thread-2" style="flex: 13.200000000000001">
                            T2: 1320
                        </div>

                        <div class="thread-segment thread-3" style="flex: 13.020000000000001">
                            T3: 1302
                        </div>

                        <div class="thread-segment thread-4" style="flex: 12.690000000000001">
                            T4: 1269
                        </div>

                        <div class="thread-segment thread-5" style="flex: 12.42">
                            T5: 1242
                        </div>

                        <div class="thread-segment thread-6" style="flex: 13.0">
                            T6: 1300
                        </div>

                        <div class="thread-segment thread-7" style="flex: 11.37">
                            T7: 1137
                        </div>

                    </div>
                </div>

                <div class="metric-row">
                    <span class="metric-label">Coefficient of Variation</span>
                    <span class="metric-value metric-excellent">0.050</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Fairness Score</span>
                    <span class="metric-value metric-excellent">5.0</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Thread Transitions</span>
                    <span class="metric-value">15.8%</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Consecutive Re-acquisitions</span>
                    <span class="metric-value">84.2%</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">GIL Acquire/Release Cycles/sec</span>
                    <span class="metric-value">6,056</span>
                </div>
                <div class="metric-row">
                    <span class="metric-label">Avg Latency per Cycle</span>
                    <span class="metric-value">165.1 Œºs</span>
                </div>
            </div>
        </div>

    </div>

    <div class="summary-section">
        <h2>üîç Analysis Summary</h2>
        
        <div class="insights-grid">
            <div class="insight-card">
                <h3>Fairness Impact</h3>
                <p><strong>FAIR mode</strong> achieves perfect thread distribution (CV: 0.006) 
                while <strong>UNFAIR</strong> and <strong>NAIVE</strong> modes show severe thread starvation 
                (CV: 0.068 and 0.050 respectively).</p>
            </div>
            
            <div class="insight-card">
                <h3>Performance Cost</h3>
                <p>The fairness mechanism adds minimal overhead: 
                <strong>+4.1%</strong> 
                higher throughput in UNFAIR mode vs FAIR mode.</p>
                <p><em>Note: This measures total GIL acquire/release cycles per second across all threads. 
                The fairness mechanism reduces overall contention throughput but ensures equal access.</em></p>
            </div>
            
            <div class="insight-card">
                <h3>Measurement Methodology</h3>
                <p><strong>GIL Cycles/sec:</strong> Total number of acquire‚Üírelease operations completed per second by all threads combined.</p>
                <p><strong>Coefficient of Variation:</strong> Standard deviation √∑ mean of GIL acquisitions per thread. CV=0 means perfectly equal distribution.</p>
                <p><strong>Thread Transitions:</strong> Percentage of times the GIL switched between different threads vs re-acquisition by the same thread.</p>
            </div>
            
            <div class="insight-card">
                <h3>Thread Starvation Prevention</h3>
                <p>FAIR mode ensures <strong>100% thread transitions</strong> 
                vs <strong>16%</strong> in UNFAIR mode, 
                preventing any thread from monopolizing the GIL.</p>
            </div>
            
            <div class="insight-card">
                <h3>Implementation Validation</h3>
                <p>NAIVE and UNFAIR modes show nearly identical behavior 
                (CV: 0.050 vs 0.068), 
                validating that the condition variable machinery without fairness behaves like a simple mutex.</p>
            </div>
        </div>
        
        <h3>Key Takeaway</h3>
        <p>The results demonstrate that <strong>thread fairness is not automatic</strong> - it requires intentional design. 
        The fastcond GIL's anti-greedy mechanism provides dramatic fairness improvements with minimal performance cost, 
        making it essential for any application where thread starvation could impact user experience or system stability.</p>
    </div>

    <div class="system-info">
        <strong>System Information:</strong>
        OS: Linux x86_64, 
        Cores: 4, 
        Python: 3.12.3<br>
        <strong>Generated:</strong> October 27, 2025 at 23:05 UTC
    </div>
    
    <div class="footer">
        <p>üé≠ <strong>fastcond GIL Fairness Analysis</strong> - Demonstrating why anti-greedy scheduling matters</p>
        <p>Thread fairness isn't accidental - it's engineered. These results show the dramatic difference between 
        naive mutex behavior and intentionally fair thread scheduling.</p>
        <p><a href="https://github.com/kristjanvalur/fastcond">Explore the implementation</a> | 
           <a href="gil-fairness-results.json">Download the data</a> | 
           <a href="index.html">View performance benchmarks</a></p>
    </div>
    
</body>
</html>